const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-BnY9sGxE.js","assets/index-DMhtMtUl.js","assets/index-X8DtfabG.css"])))=>i.map(i=>d[i]);
import{j as e,m as u,r as c,u as M,s as L,_}from"./index-DMhtMtUl.js";import{A as z,N as B}from"./Notification-BOvd0Fr_.js";const O=({show:p=!0,onClick:b,label:d="Scroll to Top"})=>e.jsx(z,{children:p&&e.jsxs(u.button,{initial:{opacity:0,scale:.7,y:40},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.7,y:40},transition:{type:"spring",stiffness:340,damping:18},onClick:b,className:"fixed bottom-7 right-6 z-50 rounded-full p-4 shadow-xl bg-white/70 dark:bg-dark-glass backdrop-blur border border-indigo-200 dark:border-dark-border text-indigo-600 dark:text-indigo-200 hover:bg-indigo-100/80 dark:hover:bg-indigo-900/70 hover:scale-105 active:scale-95 transition-all duration-200 focus:outline-none group","aria-label":d,children:[e.jsx("span",{className:"sr-only",children:d}),e.jsx("svg",{className:"w-7 h-7",fill:"none",stroke:"currentColor",strokeWidth:"2",viewBox:"0 0 24 24","aria-hidden":"true",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 15l7-7 7 7"})}),e.jsx("span",{className:"absolute opacity-0 group-hover:opacity-100 pointer-events-none bottom-14 left-1/2 -translate-x-1/2 px-3 py-1 rounded-lg text-xs font-medium shadow-lg border border-indigo-100 dark:border-dark-border bg-white/90 dark:bg-dark-glass text-gray-800 dark:text-gray-100 transition-all duration-200",children:d})]})}),J=()=>{const[p,b]=c.useState([]),[d,T]=c.useState([]),[j,v]=c.useState(!0),[N,w]=c.useState(""),[y,C]=c.useState(null),[k,g]=c.useState({type:"",message:""}),[$,F]=c.useState(!1),P=M();c.useEffect(()=>{const t=()=>F(window.scrollY>200);return window.addEventListener("scroll",t),()=>window.removeEventListener("scroll",t)},[]);const E=async()=>{try{const t=N||(p.length>0?p.map(s=>`${s.title}
${s.items.map(a=>`- ${a}`).join(`
`)}`).join(`

`)+(d.length?`

Cost Summary:
${d.map(s=>`- ${s}`).join(`
`)}`:""):"");if(!t){g({type:"error",message:"Nothing to copy yet."});return}await navigator.clipboard.writeText(t),g({type:"success",message:"Plan copied to clipboard!"})}catch{g({type:"error",message:"Failed to copy plan."})}};c.useEffect(()=>{const t=JSON.parse(localStorage.getItem("currentItinerary"));t?(C(t),S(t)):(w("No itinerary found."),v(!1))},[]);const A=t=>{console.log("ğŸ“ Formatting AI response, length:",t.length);const s=t.replace(/<[^>]*>/g,""),[a,l]=s.split(/Cost Summary:/i),r=[/Day\s*\d+/gi,/\*\*Day\s*\d+\*\*/gi,/##\s*Day\s*\d+/gi,/Day\s+\d+:/gi];let i=[];for(const o of r){const n=a.split(o).filter(Boolean);if(n.length>=1&&(i=n.map((f,D)=>{const h=f.split(`
`).map(m=>m.replace(/^[\*\#\-â€¢ğŸŒŸ]+/,"").replace(/\*\*/g,"").trim()).filter(m=>m.length>2);return{title:`Day ${D+1}`,items:h.filter(m=>m.length>0)}}),i.length>0&&i.some(f=>f.items.length>0)))break}if(i.length===0||i.every(o=>o.items.length===0)){const o=(a||t).split(`
`).map(n=>n.trim().replace(/^[\*\#\-â€¢ğŸŒŸ]+/,"").replace(/\*\*/g,"").trim()).filter(n=>n.length>2);i=[{title:"Your Itinerary",items:o.length>0?o:[t.substring(0,1e3)]}]}const x=l?l.split(`
`).map(o=>o.replace(/^[-â€¢ğŸŒŸ\*\#]+/,"").replace(/\*\*/g,"").trim()).filter(o=>o.length>2):[];return{days:i,costSummary:x}},S=async t=>{const s=new Date(t.startDate),a=new Date(t.endDate),l=Math.abs(a-s),r=Math.ceil(l/(1e3*60*60*24))+1,i=r>7?7:r;let x="";for(let n=1;n<=i;n++)x+=`
Day ${n}
- [HH:MM AM/PM] Activity name: Description. (Estimated Cost: â‚¹X)
`;const o=`
You are a luxury travel concierge. Create a detailed, professional ${i}-day itinerary for ${t.participants} people in ${t.location}.
Title: ${t.title}
Budget: â‚¹${t.budget}
Interests: ${t.type}
Range: ${t.range}

Instructions:
1. For each day, provide 4-5 distinct activities with specific times.
2. Use the format: "- [Time] Activity: Detail. (Cost: â‚¹X)"
3. Ensure costs are realistic and stay within the total â‚¹${t.budget} budget.
4. Include local dining gems and hidden spots.
5. End with a "Cost Summary:" section.

FORMAT:
${x}
`;try{v(!0);const n="AIzaSyBZ1xuZKvuthdRnIzgmhpLhxgOd0cnTVyU",h=(await(await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:o}]}]})})).json())?.candidates?.[0]?.content?.parts?.[0]?.text||"Failed to generate.";w(h);const{days:m,costSummary:R}=A(h);b(m),T(R),t.id&&await L.from("itineraries").update({ai_plan:h}).eq("id",t.id)}catch(n){w("âŒ Error generating itinerary."),g({type:"error",message:n.message})}finally{v(!1)}},I=()=>{_(()=>import("./jspdf.es.min-BnY9sGxE.js").then(t=>t.j),__vite__mapDeps([0,1,2])).then(t=>{const s=new t.jsPDF;s.setFont("helvetica"),s.setFontSize(22),s.text(y?.title||"Trip Plan",105,25,{align:"center"});let a=40;p.forEach(l=>{s.setFontSize(16),s.setTextColor(99,102,241),s.text(l.title,14,a),a+=10,s.setFontSize(11),s.setTextColor(60,60,60),l.items.forEach(r=>{a>270&&(s.addPage(),a=20);const i=s.splitTextToSize(`â€¢ ${r}`,180);s.text(i,18,a),a+=i.length*6+2}),a+=5}),s.save(`${y?.title||"Trip"}-Plan.pdf`)})};return e.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-12",children:[e.jsx(B,{type:k.type,message:k.message,onClose:()=>g({type:"",message:""})}),e.jsxs("div",{className:"text-center mb-16",children:[e.jsx(u.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"inline-block px-4 py-1 rounded-full bg-indigo-500/10 text-indigo-600 text-sm font-bold mb-4",children:"âœ¨ AI Generated Expert Plan"}),e.jsxs(u.h2,{className:"text-4xl md:text-6xl font-black tracking-tight mb-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:["Your ",e.jsx("span",{className:"navbar-logo-gradient animate-gradient-text",children:"Premium Itinerary"})]}),e.jsxs("div",{className:"flex flex-wrap justify-center gap-3",children:[e.jsxs("button",{onClick:()=>P("/planner"),className:"px-5 py-2.5 rounded-xl glass-ui font-bold hover:scale-105 transition-all flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ”™"})," Modify"]}),e.jsxs("button",{onClick:I,className:"px-5 py-2.5 rounded-xl bg-slate-900 text-white font-bold hover:scale-105 transition-all flex items-center gap-2",children:[e.jsx("span",{children:"â¬‡ï¸"})," Download PDF"]}),e.jsxs("button",{onClick:E,className:"px-5 py-2.5 rounded-xl bg-white border border-slate-200 shadow-sm font-bold hover:scale-105 transition-all flex items-center gap-2",children:[e.jsx("span",{children:"ğŸ“‹"})," Copy"]}),e.jsxs("button",{onClick:()=>y&&S(y),disabled:j,className:"px-5 py-2.5 rounded-xl bg-indigo-600 text-white font-bold hover:scale-105 transition-all flex items-center gap-2 disabled:opacity-50",children:[j?e.jsx("span",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsx("span",{children:"ğŸ”„"}),"Regenerate"]})]})]}),j?e.jsxs("div",{className:"flex flex-col items-center py-20",children:[e.jsx("div",{className:"w-24 h-24 border-8 border-indigo-100 border-t-indigo-600 rounded-full animate-spin mb-8"}),e.jsx("p",{className:"text-2xl font-bold text-slate-400 animate-pulse",children:"Designing your adventure..."})]}):p.length>0?e.jsxs("div",{className:"space-y-12",children:[p.map((t,s)=>e.jsxs(u.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:s*.1},className:"relative pl-8 md:pl-12 border-l-4 border-indigo-500/20 py-4",children:[e.jsx("div",{className:"absolute -left-4 top-0 w-8 h-8 rounded-full bg-indigo-600 text-white flex items-center justify-center font-bold shadow-lg shadow-indigo-500/40",children:s+1}),e.jsxs("div",{className:"glass-card p-6 md:p-10 mb-6",children:[e.jsxs("h3",{className:"text-3xl font-black mb-8 flex items-center gap-4",children:[e.jsx("span",{className:"text-slate-300",children:"#"})," ",t.title]}),e.jsx("div",{className:"space-y-8",children:t.items.map((a,l)=>{const r=a.match(/\[(.*?)\]/),i=r?r[1]:null,x=a.replace(/\[.*?\]/,"").trim(),[o,...n]=x.split(":");return e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 md:gap-8 group",children:[e.jsx("div",{className:"md:w-32 flex-shrink-0",children:e.jsx("span",{className:"text-lg font-black text-indigo-500 group-hover:scale-110 transition-transform inline-block",children:i||"--:--"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-xl font-bold mb-2 text-slate-800 dark:text-slate-100",children:o}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-lg leading-relaxed",children:n.join(":")})]})]},l)})})]})]},s)),d.length>0&&e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"glass-card p-8 md:p-12 border-t-8 border-emerald-500 bg-emerald-50/20",children:[e.jsxs("h3",{className:"text-3xl font-black mb-8 text-emerald-700 flex items-center gap-4",children:[e.jsx("span",{className:"text-4xl",children:"ğŸ’°"})," Cost Breakdown"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-xl bg-white/50 border border-emerald-100 shadow-sm",children:[e.jsx("span",{className:"text-slate-600 font-medium",children:t.split(":")[0]}),e.jsx("span",{className:"text-xl font-bold text-emerald-600",children:t.split(":")[1]||t})]},s))})]})]}):e.jsx("div",{className:"text-center py-20",children:e.jsx("p",{className:"text-2xl font-bold text-red-500",children:N})}),e.jsx(O,{show:$,onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),label:"Scroll Top"})]})};export{J as default};
